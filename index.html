<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>EYECHECK ‚Äî Seu olho conta a sa√∫de do seu corpo</title>
  <meta property="og:title" content="EYECHECK ‚Äî Screening por IA"/>
  <meta property="og:description" content="IA analisa 18 condi√ß√µes de sa√∫de pelo seu olho. Doen√ßas oculares e sist√™micas detectadas com Machine Learning."/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="/static/hero-eye.jpg"/>
  <meta name="description" content="EYECHECK ‚Äî IA que analisa seus olhos e detecta sinais de doen√ßas oculares e sist√™micas."/>
  <meta name="theme-color" content="#FAFBFC"/>
  <meta name="mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="default"/>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üëÅÔ∏è</text></svg>"/>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=JetBrains+Mono:wght@400;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
  <style>
    :root {
      --bg: #FAFBFC;
      --bg2: #F4F7FB;
      --surface: #FFFFFF;
      --ink: #111827;
      --text: #1F2937;
      --muted: #6B7280;
      --dim: #94A3B8;
      --border: rgba(17,24,39,0.10);
      --primary: #2563EB;
      --primary2: #1A56DB;
      --secondary: #10B981;
      --secondary2: #059669;
      --amber: #F59E0B;
      --coral: rgba(239,68,68,0.85);
      --shadow: 0 16px 50px rgba(15,23,42,0.10);
      --shadow-soft: 0 10px 30px rgba(15,23,42,0.08);
      --radius: 16px;
      --grad: linear-gradient(135deg, rgba(37,99,235,0.12), rgba(16,185,129,0.10));
      --grad-strong: linear-gradient(135deg, rgba(37,99,235,0.95), rgba(16,185,129,0.90));
      --fd: "DM Serif Display", serif;
      --fb: "Plus Jakarta Sans", system-ui, -apple-system, sans-serif;
      --fm: "JetBrains Mono", ui-monospace, monospace;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    html { scroll-behavior:smooth; }
    body {
      font-family: var(--fb);
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
      line-height: 1.6;
    }

    /* ===== MEDICAL GRID BACKGROUND ===== */
    .bg-grid {
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      background-image:
        radial-gradient(circle at 20% 20%, rgba(37,99,235,0.08) 0 2px, transparent 3px),
        radial-gradient(circle at 70% 30%, rgba(16,185,129,0.08) 0 2px, transparent 3px),
        radial-gradient(circle at 40% 80%, rgba(245,158,11,0.06) 0 2px, transparent 3px),
        linear-gradient(rgba(37,99,235,0.035) 1px, transparent 1px),
        linear-gradient(90deg, rgba(37,99,235,0.035) 1px, transparent 1px);
      background-size: 380px 380px, 420px 420px, 460px 460px, 64px 64px, 64px 64px;
    }
    .bg-orb {
      position: fixed; border-radius: 999px; filter: blur(110px); z-index: 0; pointer-events: none;
      animation: orbFloat 18s ease-in-out infinite;
    }
    .bg-orb-1 { width: 520px; height: 520px; background: rgba(37,99,235,0.10); top: -180px; right: -200px; }
    .bg-orb-2 { width: 460px; height: 460px; background: rgba(16,185,129,0.08); bottom: -180px; left: -200px; animation-delay: -9s; }
    @keyframes orbFloat { 0%,100%{ transform:translate(0,0); } 50%{ transform:translate(34px,-26px); } }

    /* ===== FLOATING PARTICLES ===== */
    .particle {
      position: fixed; width: 6px; height: 6px; border-radius: 50%;
      background: rgba(37,99,235,0.18); box-shadow: 0 0 0 6px rgba(37,99,235,0.05);
      animation: drift 14s linear infinite; opacity: 0.7; pointer-events: none; z-index: 0;
    }
    .particle.g { background: rgba(16,185,129,0.18); box-shadow: 0 0 0 6px rgba(16,185,129,0.05); }
    .particle.a { background: rgba(245,158,11,0.16); box-shadow: 0 0 0 6px rgba(245,158,11,0.04); }
    @keyframes drift { 0%{ transform:translate3d(0,0,0); opacity:.3; } 30%{ opacity:.85; } 100%{ transform:translate3d(0,-140px,0); opacity:.3; } }

    /* ===== ANIMATIONS ===== */
    @keyframes fadeUp { from { opacity:0; transform:translateY(24px); } to { opacity:1; transform:translateY(0); } }
    @keyframes slideUp { from { opacity:0; transform:translateY(40px); } to { opacity:1; transform:translateY(0); } }
    @keyframes pulse { 0%,100%{ transform:scale(1); opacity:1; } 50%{ transform:scale(0.86); opacity:.45; } }
    @keyframes pop { 0%{ transform:scale(0); } 60%{ transform:scale(1.06); } 100%{ transform:scale(1); } }
    @keyframes barFill { from { width:0%; } }
    @keyframes checkDraw { to { stroke-dashoffset:0; } }
    @keyframes scanSweep { 0%{ transform:translateY(0); opacity:.2; } 25%{ opacity:.85; } 50%{ transform:translateY(200px); opacity:.9; } 75%{ opacity:.75; } 100%{ transform:translateY(0); opacity:.2; } }
    @keyframes scanUnder { from{ left:-60%; } to{ left:110%; } }
    @keyframes ekgDraw { 0%{ stroke-dashoffset:540; opacity:.25; } 35%{ opacity:.9; } 55%{ stroke-dashoffset:0; opacity:.9; } 100%{ stroke-dashoffset:-540; opacity:.25; } }
    @keyframes stagger { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }
    @keyframes breathe { 0%,100%{ transform:scale(1); } 50%{ transform:scale(1.02); } }
    @keyframes bob { 0%,100%{ transform:translateY(0); } 50%{ transform:translateY(-8px); } }

    .bf { transition: width 1.5s cubic-bezier(.22,1,.36,1); }
    .btn { transition: all .25s; cursor: pointer; }
    .btn:hover { transform: translateY(-2px); }
    .btn:active { transform: translateY(0); }
    .mono { font-family: var(--fm); }

    /* scan hover effect */
    .scan-hover { position:relative; overflow:hidden; }
    .scan-hover::after {
      content:""; position:absolute; left:-60%; top:0; height:100%; width:60%;
      background: linear-gradient(90deg, transparent, rgba(16,185,129,0.10), transparent);
      transform: skewX(-18deg); opacity:0;
    }
    .scan-hover:hover::after { opacity:1; animation: scanUnder 0.9s ease-out; }

    /* EKG divider */
    .ekg-wrap { position:relative; height:32px; max-width:640px; margin:0 auto; z-index:1; padding:0 16px; }
    .ekg {
      width:100%; height:32px; border-radius:999px;
      background: linear-gradient(90deg, rgba(37,99,235,0.06), rgba(16,185,129,0.06));
      border: 1px solid rgba(17,24,39,0.05);
      display:flex; align-items:center; justify-content:center; overflow:hidden;
    }
    .ekg svg { width:100%; max-width:580px; height:20px; opacity:.8; }
    .ekg path {
      stroke: rgba(37,99,235,0.40); stroke-width:2.2; fill:none;
      stroke-linecap:round; stroke-linejoin:round;
      stroke-dasharray:540; stroke-dashoffset:540;
      animation: ekgDraw 2.8s ease-in-out infinite;
    }
    .ekg .g path { stroke: rgba(16,185,129,0.38); animation-delay:.25s; opacity:.9; }

    /* ===== CARDS ===== */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 4px 16px rgba(15,23,42,0.05);
      transition: transform .3s, box-shadow .3s, border-color .3s;
    }
    .card:hover { border-color: rgba(37,99,235,0.16); box-shadow: 0 8px 24px rgba(15,23,42,0.08); }

    /* ===== SCANNER ===== */
    .scan-line {
      position:absolute; top:10%; left:-20%; width:160%; height:3px;
      background: linear-gradient(90deg, transparent, rgba(16,185,129,0.92), rgba(37,99,235,0.85), transparent);
      filter: blur(0.1px); opacity:.8;
      animation: scanSweep 2.4s ease-in-out infinite;
    }
    .scanner-brackets .sb {
      position:absolute; width:22px; height:22px; border-color:var(--primary); border-style:solid; border-width:0; z-index:11;
    }
    .sb-tl { top:8px; left:8px; border-top-width:2px; border-left-width:2px; border-radius:4px 0 0 0; }
    .sb-tr { top:8px; right:8px; border-top-width:2px; border-right-width:2px; border-radius:0 4px 0 0; }
    .sb-bl { bottom:8px; left:8px; border-bottom-width:2px; border-left-width:2px; border-radius:0 0 0 4px; }
    .sb-br { bottom:8px; right:8px; border-bottom-width:2px; border-right-width:2px; border-radius:0 0 4px 0; }

    /* ===== DETECT ITEMS ===== */
    .detect-item {
      display:flex; gap:12px; background:var(--surface);
      border:1px solid rgba(17,24,39,0.10); border-radius:16px;
      padding:14px; transition: transform .25s, box-shadow .25s;
      box-shadow: 0 8px 20px rgba(15,23,42,0.05); position:relative; overflow:hidden;
    }
    .detect-item::before {
      content:""; position:absolute; left:0; top:0; bottom:0; width:4px;
      background: rgba(37,99,235,0.40); border-radius:4px 0 0 4px;
    }
    .detect-item:hover { transform:translateY(-2px); box-shadow:var(--shadow-soft); }
    .detect-item.systemic::before { background: rgba(16,185,129,0.50); }
    .detect-item.high::before { background: var(--coral); }
    .detect-item.moderate::before { background: rgba(245,158,11,0.70); }
    .detect-item.low::before { background: rgba(16,185,129,0.50); }
    .detect-item.none::before { background: rgba(37,99,235,0.30); }

    /* severity badge */
    .severity-badge {
      display:inline-flex; align-items:center; gap:6px;
      font-size:10px; font-weight:900; letter-spacing:0.12em; text-transform:uppercase;
      padding:5px 10px; border-radius:999px;
      border:1px solid rgba(17,24,39,0.08); background:rgba(249,250,251,0.75);
      color:rgba(17,24,39,0.70); white-space:nowrap;
    }
    .severity-badge .dot {
      width:7px; height:7px; border-radius:50%;
      background: rgba(16,185,129,0.80); box-shadow: 0 0 0 5px rgba(16,185,129,0.10);
    }
    .severity-badge.moderate .dot { background: rgba(245,158,11,0.90); box-shadow: 0 0 0 5px rgba(245,158,11,0.10); }
    .severity-badge.high .dot { background: var(--coral); box-shadow: 0 0 0 5px rgba(239,68,68,0.08); }

    /* ring gauge */
    .ring { display:block; }
    .ring .bg-ring { stroke: rgba(17,24,39,0.08); stroke-width:8; fill:none; }
    .ring .fg-ring { stroke: var(--primary); stroke-width:8; fill:none; stroke-linecap:round; transition: stroke-dashoffset 1.2s ease; }

    /* dual columns */
    .dual { display:flex; gap:8px; }
    @media(max-width:700px) {
      .dual { flex-direction:column !important; }
      .home-grid3 { grid-template-columns: 1fr 1fr !important; }
      .home-grid3 .stats-col { grid-column: 1 / -1; flex-direction: row !important; }
      .home-grid3 .stats-col .card { flex:1; }
    }
  </style>
</head>
<body>
  <div class="bg-grid"></div>
  <div class="bg-orb bg-orb-1"></div>
  <div class="bg-orb bg-orb-2"></div>
  <div id="root"></div>

  <script type="text/babel">
const {useState, useRef, useCallback} = React;

const urgC = u => u==="high"?"#ef4444":u==="moderate"?"#f59e0b":u==="low"?"#10B981":"#2563EB";
const urgL = u => u==="high"?"ALTA":u==="moderate"?"MODERADA":u==="low"?"BAIXA":"NENHUMA";
const urgBg = u => u==="high"?"rgba(239,68,68,0.08)":u==="moderate"?"rgba(245,158,11,0.08)":u==="low"?"rgba(16,185,129,0.08)":"rgba(37,99,235,0.06)";
const urgBorder = u => u==="high"?"rgba(239,68,68,0.18)":u==="moderate"?"rgba(245,158,11,0.18)":u==="low"?"rgba(16,185,129,0.16)":"rgba(37,99,235,0.12)";
const sevClass = l => l==="high"?"high":l==="moderate"?"moderate":"low";

const GRID_OC = [
  {i:"‚ö™",n:"Catarata",c:"var(--primary)"},{i:"üî¥",n:"Conjuntivite",c:"#ef4444"},{i:"ü©∏",n:"Hemorragia",c:"#dc2626"},
  {i:"üü°",n:"Icter√≠cia",c:"#eab308"},{i:"üî∫",n:"Pter√≠gio",c:"#f97316"},{i:"üëÅÔ∏è",n:"Ptose",c:"var(--primary)"},
  {i:"ü´ß",n:"Ter√ßol",c:"#ec4899"},{i:"üü†",n:"Uve√≠te",c:"#f59e0b"},
];
const GRID_SY = [
  {i:"ü©∏",n:"Anemia",c:"#f87171"},{i:"‚≠ï",n:"Arco Senil",c:"var(--dim)"},{i:"üîµ",n:"Esclera Azul",c:"#60a5fa"},
  {i:"üíú",n:"Diabetes",c:"#a78bfa"},{i:"üëÄ",n:"Tireoide",c:"#fb923c"},{i:"üü§",n:"Wilson",c:"#d97706"},
  {i:"üíß",n:"Renal",c:"var(--secondary)"},{i:"üü°",n:"Colesterol",c:"#fbbf24"},
];

const WA = s => <svg width={s} height={s} viewBox="0 0 24 24" fill="#fff"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>;

// EKG SVG divider component
const EKGDivider = () => (
  <div className="ekg-wrap" style={{margin:"10px auto"}}>
    <div className="ekg">
      <svg viewBox="0 0 600 30" preserveAspectRatio="none">
        <path d="M0,15 L80,15 L100,15 L120,2 L140,28 L160,15 L200,15 L260,15 L280,2 L300,28 L320,15 L380,15 L440,15 L460,2 L480,28 L500,15 L600,15"/>
        <g className="g"><path d="M0,15 L80,15 L100,15 L120,2 L140,28 L160,15 L200,15 L260,15 L280,2 L300,28 L320,15 L380,15 L440,15 L460,2 L480,28 L500,15 L600,15"/></g>
      </svg>
    </div>
  </div>
);

// Floating particles
const Particles = () => (
  <>{[
    {l:"8%",b:"15%",cls:"",d:12,dl:0},{l:"22%",b:"45%",cls:"g",d:16,dl:2},{l:"42%",b:"70%",cls:"",d:11,dl:4},
    {l:"58%",b:"25%",cls:"a",d:18,dl:1},{l:"75%",b:"55%",cls:"g",d:13,dl:3},{l:"90%",b:"80%",cls:"",d:15,dl:5},
  ].map((p,i) => (
    <div key={i} className={`particle ${p.cls}`} style={{left:p.l,bottom:p.b,animationDuration:p.d+"s",animationDelay:p.dl+"s"}}/>
  ))}</>
);

// Ring gauge SVG
const RingGauge = ({pct, size=80, strokeWidth=7, color="var(--primary)"}) => {
  const r = (size - strokeWidth) / 2;
  const c = 2 * Math.PI * r;
  const offset = c - (pct / 100) * c;
  return (
    <svg className="ring" width={size} height={size} viewBox={`0 0 ${size} ${size}`}>
      <circle className="bg-ring" cx={size/2} cy={size/2} r={r} strokeWidth={strokeWidth}/>
      <circle className="fg-ring" cx={size/2} cy={size/2} r={r} strokeWidth={strokeWidth}
        stroke={color} strokeDasharray={c} strokeDashoffset={offset}
        transform={`rotate(-90 ${size/2} ${size/2})`}/>
      <text x={size/2} y={size/2} textAnchor="middle" dominantBaseline="central"
        fontFamily="var(--fm)" fontWeight="700" fontSize={size*.22} fill="var(--ink)">
        {pct}%
      </text>
    </svg>
  );
};

function App() {
  const [img,setImg]=useState(null);
  const [b64,setB64]=useState(null);
  const [res,setRes]=useState(null);
  const [busy,setBusy]=useState(false);
  const [err,setErr]=useState(null);
  const [drag,setDrag]=useState(false);
  const [apiReady,setApiReady]=useState(false);
  const fRef=useRef(null);
  const url=typeof window!=="undefined"?window.location.href:"";

  React.useEffect(()=>{
    const wake=()=>fetch("/health").then(r=>{if(r.ok)setApiReady(true)}).catch(()=>setTimeout(wake,3000));
    wake();
  },[]);

  const load=useCallback(file=>{
    if(!file?.type.startsWith("image/"))return;
    setRes(null);setErr(null);
    const reader=new FileReader();
    reader.onload=()=>setB64(reader.result.split(",")[1]);
    reader.readAsDataURL(file);
    createImageBitmap(file).then(bmp=>{
      const s=Math.min(1,600/Math.max(bmp.width,bmp.height));
      const w=Math.round(bmp.width*s),h=Math.round(bmp.height*s);
      const cv=document.createElement("canvas");
      cv.width=w;cv.height=h;cv.getContext("2d").drawImage(bmp,0,0,w,h);bmp.close();
      setImg(cv.toDataURL("image/jpeg",0.75));
    }).catch(()=>setImg("ok"));
  },[]);

  const analyze=async()=>{
    if(!b64)return;
    setBusy(true);setErr(null);setRes(null);
    try{
      const r=await fetch("/predict/full",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:b64})});
      const d=await r.json();if(d.error)throw new Error(d.error);
      setTimeout(()=>{setRes(d);setBusy(false);},1200);
    }catch(e){setErr("Erro: "+e.message);setBusy(false)}
  };

  const reset=()=>{setImg(null);setB64(null);setRes(null);setErr(null)};

  const shareApp=()=>{
    const msg="üëÅÔ∏è EYECHECK ‚Äî IA que analisa seus olhos e detecta sinais de doen√ßas (diabetes, anemia, colesterol, tireoide) s√≥ com uma foto!\n\nüî¨ 18 condi√ß√µes detectadas com Machine Learning\nüì± Funciona no celular\n\nTesta a√≠: "+url;
    window.open("https://api.whatsapp.com/send?text="+encodeURIComponent(msg),"_blank");
  };

  const shareResult=()=>{
    if(!res)return;
    const p=getPrimary();
    const msg="üëÅÔ∏è Fiz um screening com EYECHECK!\n\nüî¨ Resultado: "+(p?.top_prediction_pt||"Normal")+" ("+Math.round((p?.confidence||0)*100)+"%)\n‚ö†Ô∏è Urg√™ncia: "+urgL(res.combined_urgency)+"\n\nüì± Fa√ßa o seu: "+url;
    window.open("https://api.whatsapp.com/send?text="+encodeURIComponent(msg),"_blank");
  };

  const getPrimary=()=>{
    if(!res)return null;
    const oc=res.ocular_analysis,sy=res.systemic_analysis;
    if(oc.top_prediction==="normal"&&sy.top_prediction==="normal")return oc;
    const uv={none:0,low:1,moderate:2,high:3};
    if(oc.top_prediction==="normal")return sy;
    if(sy.top_prediction==="normal")return oc;
    if((uv[sy.urgency]||0)>(uv[oc.urgency]||0))return sy;
    if((uv[oc.urgency]||0)>(uv[sy.urgency]||0))return oc;
    return sy.confidence>oc.confidence?sy:oc;
  };
  const getSecondary=()=>{
    if(!res)return null;
    const oc=res.ocular_analysis,sy=res.systemic_analysis;
    if(oc.top_prediction==="normal"||sy.top_prediction==="normal")return null;
    const p=getPrimary();
    return p===oc?sy:oc;
  };
  const bothNormal=res&&res.ocular_analysis?.top_prediction==="normal"&&res.systemic_analysis?.top_prediction==="normal";
  const primary=getPrimary();
  const secondary=getSecondary();

  return (
  <div style={{minHeight:"100vh",position:"relative",zIndex:1}}>
    <Particles/>
    <input ref={fRef} type="file" accept="image/*" capture="environment" style={{display:"none"}} onChange={e=>load(e.target.files?.[0])}/>

    {/* ‚ïê‚ïê‚ïê HEADER NAV ‚ïê‚ïê‚ïê */}
    <header style={{
      position:"sticky",top:0,zIndex:50,padding:"10px 14px",
      display:"flex",alignItems:"center",justifyContent:"space-between",
      borderBottom:"1px solid var(--border)",
      background:"rgba(250,251,252,0.82)",backdropFilter:"blur(18px)",WebkitBackdropFilter:"blur(18px)"
    }}>
      <div style={{display:"flex",alignItems:"center",gap:10}}>
        <div style={{
          width:34,height:34,borderRadius:10,
          background:"var(--grad-strong)",
          display:"flex",alignItems:"center",justifyContent:"center",
          fontSize:15,color:"#fff",fontWeight:900
        }}>‚óâ</div>
        <div>
          <div style={{fontFamily:"var(--fd)",fontSize:17,color:"var(--ink)",letterSpacing:"-0.02em",lineHeight:1.1}}>EyeCheck</div>
          <div style={{fontSize:10,color:"var(--dim)",fontFamily:"var(--fm)",letterSpacing:".06em",fontWeight:600}}>V4.0 ¬∑ AI SCREENING</div>
        </div>
      </div>
      <div style={{display:"flex",alignItems:"center",gap:8}}>
        <div style={{
          background:apiReady?"rgba(16,185,129,0.08)":"rgba(245,158,11,0.08)",
          border:"1px solid "+(apiReady?"rgba(16,185,129,0.18)":"rgba(245,158,11,0.18)"),
          borderRadius:999,padding:"5px 11px",fontSize:10,fontFamily:"var(--fm)",fontWeight:700,
          color:apiReady?"var(--secondary2)":"var(--amber)",letterSpacing:".08em",
          display:"flex",alignItems:"center",gap:6
        }}>
          <span style={{
            width:7,height:7,borderRadius:"50%",
            background:apiReady?"var(--secondary)":"var(--amber)",
            boxShadow:apiReady?"0 0 0 5px rgba(16,185,129,0.12)":"0 0 0 5px rgba(245,158,11,0.12)",
            animation:"pulse 2.2s ease-in-out infinite"
          }}/>
          {apiReady?"ONLINE":"INICIANDO..."}
        </div>
      </div>
    </header>

    <main style={{maxWidth:900,margin:"0 auto",padding:"18px 24px"}}>

    {/* ‚ïê‚ïê‚ïê HOME ‚ïê‚ïê‚ïê */}
    {!img&&(
      <div style={{animation:"fadeUp .5s ease"}}>
        {/* ROW 1: Hero left + Upload right */}
        <div style={{display:"flex",gap:16,marginBottom:14,alignItems:"stretch",flexWrap:"wrap"}}>
          {/* LEFT ‚Äî Hero info */}
          <div style={{flex:"1 1 360px",display:"flex",alignItems:"center",gap:16,minWidth:0}}>
            {/* Eye scanner */}
            <div style={{
              position:"relative",width:100,height:100,flexShrink:0,
              animation:"breathe 4s ease-in-out infinite"
            }}>
              <img src="/static/hero-eye.jpg" alt="EYECHECK" style={{
                width:90,height:90,borderRadius:"50%",objectFit:"cover",
                position:"absolute",top:5,left:5,zIndex:2,
                boxShadow:"0 0 0 1px rgba(37,99,235,0.12), 0 0 20px rgba(37,99,235,0.10)"
              }}/>
              <div style={{position:"absolute",inset:0,borderRadius:"50%",border:"1.5px dashed rgba(16,185,129,0.28)"}}/>
              <div style={{position:"absolute",top:"50%",left:"14%",right:"14%",height:1,background:"rgba(16,185,129,0.18)",transform:"translateY(-50%)",zIndex:3}}/>
              <div style={{position:"absolute",left:"50%",top:"14%",bottom:"14%",width:1,background:"rgba(16,185,129,0.18)",transform:"translateX(-50%)",zIndex:3}}/>
              <div style={{position:"absolute",left:"10%",right:"10%",height:2,zIndex:4,background:"linear-gradient(90deg,transparent,rgba(16,185,129,0.85),rgba(37,99,235,0.75),transparent)",animation:"scanSweep 2.4s ease-in-out infinite",top:"15%"}}/>
            </div>
            {/* Text */}
            <div style={{minWidth:0}}>
              <div style={{
                display:"inline-flex",alignItems:"center",gap:6,
                background:"rgba(37,99,235,0.06)",border:"1px solid rgba(37,99,235,0.12)",
                borderRadius:999,padding:"4px 12px",fontSize:10,color:"var(--primary2)",
                fontWeight:800,letterSpacing:".08em",textTransform:"uppercase",marginBottom:6
              }}>
                <span style={{width:6,height:6,borderRadius:"50%",background:"var(--secondary)",boxShadow:"0 0 0 3px rgba(16,185,129,0.10)",animation:"pulse 2.2s ease-in-out infinite"}}/>
                SCREENING POR IA
              </div>
              <h1 style={{fontFamily:"var(--fd)",fontSize:26,lineHeight:1.15,color:"var(--ink)",marginBottom:5,letterSpacing:"-0.02em"}}>
                Seu olho conta a sa√∫de <span style={{background:"linear-gradient(90deg,var(--primary),var(--secondary))",WebkitBackgroundClip:"text",backgroundClip:"text",color:"transparent"}}>do seu corpo</span>
              </h1>
              <p style={{color:"var(--muted)",fontSize:13,fontWeight:400,lineHeight:1.5,margin:0}}>IA analisa 18 condi√ß√µes pelo seu olho ‚Äî doen√ßas oculares e sinais sist√™micos em segundos.</p>
            </div>
          </div>

          {/* RIGHT ‚Äî Upload CTA */}
          <div onClick={()=>fRef.current?.click()}
            onDragOver={e=>{e.preventDefault();setDrag(true)}} onDragLeave={()=>setDrag(false)}
            onDrop={e=>{e.preventDefault();setDrag(false);load(e.dataTransfer.files[0])}}
            className="btn card scan-hover"
            style={{
              flex:"0 0 220px",borderColor:drag?"var(--primary)":"var(--border)",
              padding:"22px 16px",textAlign:"center",cursor:"pointer",
              boxShadow:drag?"0 0 0 3px rgba(37,99,235,0.08), 0 4px 16px rgba(15,23,42,0.06)":"0 4px 16px rgba(15,23,42,0.05)",
              position:"relative",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"
            }}>
            <div style={{position:"absolute",top:0,left:0,right:0,height:3,background:"var(--grad-strong)",borderRadius:"16px 16px 0 0"}}/>
            <div style={{fontSize:32,marginBottom:6}}>üì∏</div>
            <div style={{fontFamily:"var(--fd)",fontSize:18,color:"var(--ink)",marginBottom:3}}>Iniciar An√°lise</div>
            <div style={{fontSize:12,color:"var(--muted)",fontWeight:400,marginBottom:8}}>Foto ou upload</div>
            <div style={{display:"flex",gap:8}}>
              <span style={{fontSize:10,fontFamily:"var(--fm)",color:"var(--dim)",background:"rgba(37,99,235,0.05)",padding:"3px 9px",borderRadius:6,border:"1px solid rgba(37,99,235,0.08)"}}>üì± C√ÇMERA</span>
              <span style={{fontSize:10,fontFamily:"var(--fm)",color:"var(--dim)",background:"rgba(16,185,129,0.05)",padding:"3px 9px",borderRadius:6,border:"1px solid rgba(16,185,129,0.08)"}}>üìÅ ARQUIVO</span>
            </div>
          </div>
        </div>

        {/* ROW 2: Disease grids + Stats */}
        <div className="home-grid3" style={{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:10,marginBottom:14,alignItems:"start"}}>
          {/* Ocular */}
          <div className="card scan-hover" style={{padding:"10px 12px",position:"relative",overflow:"hidden"}}>
            <div style={{position:"absolute",top:0,left:0,right:0,height:2,background:"linear-gradient(90deg, rgba(37,99,235,0.80), rgba(37,99,235,0.40))"}}/>
            <div style={{fontSize:11,fontFamily:"var(--fm)",color:"var(--primary)",marginBottom:6,fontWeight:700,letterSpacing:".08em"}}>üîç OCULAR ¬∑ 8</div>
            <div style={{display:"flex",flexWrap:"wrap",gap:4}}>
              {GRID_OC.map(d=>(
                <div key={d.n} style={{background:"rgba(37,99,235,0.04)",border:"1px solid rgba(37,99,235,0.08)",borderRadius:6,padding:"3px 8px",fontSize:11,color:"var(--text)",display:"flex",alignItems:"center",gap:3,fontWeight:500}}>
                  <span style={{fontSize:11}}>{d.i}</span>{d.n}
                </div>
              ))}
            </div>
          </div>
          {/* Systemic */}
          <div className="card scan-hover" style={{padding:"10px 12px",position:"relative",overflow:"hidden"}}>
            <div style={{position:"absolute",top:0,left:0,right:0,height:2,background:"linear-gradient(90deg, rgba(16,185,129,0.80), rgba(16,185,129,0.40))"}}/>
            <div style={{fontSize:11,fontFamily:"var(--fm)",color:"var(--secondary2)",marginBottom:6,fontWeight:700,letterSpacing:".08em"}}>ü´Ä SIST√äMICO ¬∑ 8</div>
            <div style={{display:"flex",flexWrap:"wrap",gap:4}}>
              {GRID_SY.map(d=>(
                <div key={d.n} style={{background:"rgba(16,185,129,0.04)",border:"1px solid rgba(16,185,129,0.08)",borderRadius:6,padding:"3px 8px",fontSize:11,color:"var(--text)",display:"flex",alignItems:"center",gap:3,fontWeight:500}}>
                  <span style={{fontSize:11}}>{d.i}</span>{d.n}
                </div>
              ))}
            </div>
          </div>
          {/* Stats mini */}
          <div className="stats-col" style={{display:"flex",flexDirection:"column",gap:6,minWidth:90}}>
            {[{n:"18",l:"Condi√ß√µes"},{n:"2",l:"Modelos"},{n:"<3s",l:"An√°lise"}].map((s,i)=>(
              <div key={i} className="card" style={{padding:"8px 12px",textAlign:"center"}}>
                <div style={{fontFamily:"var(--fd)",fontSize:22,color:"var(--primary2)",lineHeight:1}}>{s.n}</div>
                <div style={{fontSize:9,color:"var(--muted)",textTransform:"uppercase",letterSpacing:".08em",fontWeight:800}}>{s.l}</div>
              </div>
            ))}
          </div>
        </div>

        {/* ROW 3: WhatsApp + disclaimer */}
        <div style={{display:"flex",gap:12,alignItems:"center"}}>
          <button onClick={shareApp} className="btn" style={{
            flex:"0 0 auto",padding:"10px 22px",borderRadius:10,border:"none",
            background:"linear-gradient(135deg,#25D366,#128C7E)",color:"#fff",
            fontFamily:"var(--fb)",fontSize:13,fontWeight:700,
            display:"flex",alignItems:"center",gap:7,
            boxShadow:"0 4px 16px rgba(37,211,102,0.16)"
          }}>
            {WA(16)} Enviar pra um amigo
          </button>
          <div style={{flex:1,fontSize:11,color:"var(--dim)",lineHeight:1.4}}>
            ‚ö†Ô∏è Triagem de bem-estar ‚Äî n√£o √© diagn√≥stico m√©dico
            <span style={{display:"block",fontSize:9,fontFamily:"var(--fm)",letterSpacing:".04em",marginTop:2}}>EYECHECK V4.0 ¬∑ MobileNetV2 ¬∑ 18 condi√ß√µes ¬∑ BBG ¬© 2026</span>
          </div>
        </div>
      </div>
    )}

    {/* ‚ïê‚ïê‚ïê ANALYSIS VIEW ‚ïê‚ïê‚ïê */}
    {img&&(
      <div style={{animation:"fadeUp .5s ease"}}>
        {/* Scanner frame */}
        <div className="card" style={{position:"relative",borderRadius:14,overflow:"hidden",marginBottom:8,padding:0}}>
          <div style={{position:"absolute",top:0,left:0,right:0,height:3,background:"var(--grad-strong)",zIndex:10}}/>
          {img&&img!=="ok"?(
            <img src={img} alt="Eye" style={{width:"100%",display:"block",maxHeight:240,objectFit:"contain",background:"#0B1220"}}/>
          ):(
            <div style={{width:"100%",height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"#0B1220"}}>
              <span style={{fontSize:10,color:"var(--secondary)",fontFamily:"var(--fm)"}}>IMAGEM CARREGADA</span>
            </div>
          )}
          {/* Scanner overlay */}
          {busy&&(
            <div style={{position:"absolute",inset:0,background:"rgba(11,18,32,.40)"}}>
              <div className="scanner-brackets">
                <div className="sb sb-tl"/><div className="sb sb-tr"/><div className="sb sb-bl"/><div className="sb sb-br"/>
              </div>
              <div className="scan-line"/>
              <div style={{position:"absolute",bottom:10,left:0,right:0,textAlign:"center"}}>
                <div style={{
                  display:"inline-block",background:"rgba(255,255,255,0.92)",borderRadius:10,
                  padding:"5px 12px",fontFamily:"var(--fm)",fontSize:9,
                  color:"var(--primary)",letterSpacing:".06em",fontWeight:700,
                  border:"1px solid rgba(37,99,235,0.14)",
                  boxShadow:"0 6px 20px rgba(15,23,42,0.10)"
                }}>
                  ANALISANDO PADR√ïES OCULARES...
                </div>
              </div>
            </div>
          )}
          {/* Result badge */}
          {res&&primary&&!bothNormal&&(
            <div style={{
              position:"absolute",top:8,right:8,
              background:urgC(primary.urgency),color:"#fff",borderRadius:8,
              padding:"3px 8px",fontSize:9,fontWeight:800,fontFamily:"var(--fm)",letterSpacing:".05em",
              boxShadow:"0 3px 10px rgba(0,0,0,0.15)"
            }}>{primary.top_prediction_pt?.toUpperCase()}</div>
          )}
        </div>

        {/* Action buttons */}
        <div style={{display:"flex",gap:6,marginBottom:10}}>
          {!busy&&!res&&(
            <button onClick={apiReady?analyze:undefined} className="btn" style={{
              flex:1,padding:"10px",borderRadius:12,border:"none",
              background:apiReady?"var(--grad-strong)":"rgba(37,99,235,0.08)",
              color:apiReady?"#fff":"var(--dim)",
              fontFamily:"var(--fb)",fontSize:12,fontWeight:800,letterSpacing:".05em",textTransform:"uppercase",
              boxShadow:apiReady?"0 6px 20px rgba(37,99,235,0.16)":"none",opacity:apiReady?1:.6
            }}>{apiReady?"Analisar":"Iniciando..."}</button>
          )}
          <button onClick={reset} className="btn" style={{
            flex:res?1:0,minWidth:38,padding:"10px",borderRadius:12,
            border:"1px solid var(--border)",background:"var(--surface)",color:"var(--muted)",
            fontFamily:"var(--fb)",fontSize:12,fontWeight:600
          }}>{res?"Nova Foto":"‚úï"}</button>
          {res&&(
            <button onClick={shareResult} className="btn" style={{
              flex:1,padding:"10px",borderRadius:12,border:"none",
              background:"linear-gradient(135deg,#25D366,#128C7E)",color:"#fff",
              fontFamily:"var(--fb)",fontSize:12,fontWeight:700,
              display:"flex",alignItems:"center",justifyContent:"center",gap:6,
              boxShadow:"0 6px 18px rgba(37,211,102,0.16)"
            }}>
              {WA(14)} Compartilhar
            </button>
          )}
        </div>

        {/* ‚ïê‚ïê‚ïê BOTH NORMAL ‚ïê‚ïê‚ïê */}
        {bothNormal&&(
          <div className="card" style={{
            textAlign:"center",padding:"20px 16px",marginBottom:10,
            borderColor:"rgba(16,185,129,0.20)",animation:"pop .5s ease",
            boxShadow:"0 6px 24px rgba(16,185,129,0.06)",position:"relative",overflow:"hidden"
          }}>
            <div style={{position:"absolute",top:0,left:0,right:0,height:3,background:"linear-gradient(90deg,var(--secondary),var(--primary))"}}/>
            <svg width="48" height="48" viewBox="0 0 64 64" style={{margin:"0 auto 8px"}}>
              <circle cx="32" cy="32" r="28" fill="none" stroke="var(--secondary)" strokeWidth="2.5" opacity=".25"/>
              <path d="M20 32 L28 40 L44 24" fill="none" stroke="var(--secondary)" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" strokeDasharray="40" strokeDashoffset="40" style={{animation:"checkDraw .8s .3s forwards"}}/>
            </svg>
            <div style={{fontFamily:"var(--fd)",fontSize:18,color:"var(--secondary2)",marginBottom:3}}>Olhos Saud√°veis</div>
            <div style={{fontSize:12,color:"var(--muted)",fontWeight:400}}>Nenhum sinal de doen√ßa ocular ou sist√™mica detectado</div>
          </div>
        )}

        {/* ‚ïê‚ïê‚ïê COMBINED URGENCY ‚ïê‚ïê‚ïê */}
        {res&&!bothNormal&&(
          <div style={{marginBottom:8,animation:"slideUp .6s ease"}}>
            <div className="card" style={{
              padding:"10px 12px",display:"flex",alignItems:"center",gap:10,
              background:urgBg(res.combined_urgency),
              borderColor:urgBorder(res.combined_urgency)
            }}>
              <div style={{
                width:34,height:34,borderRadius:10,
                background:"rgba(255,255,255,0.75)",border:"1px solid "+urgBorder(res.combined_urgency),
                display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,flexShrink:0
              }}>
                {res.combined_urgency==="high"?"üî¥":res.combined_urgency==="moderate"?"üü°":"üü¢"}
              </div>
              <div style={{flex:1}}>
                <div style={{fontSize:9,fontFamily:"var(--fm)",color:urgC(res.combined_urgency),letterSpacing:".10em",fontWeight:700}}>URG√äNCIA</div>
                <div style={{fontSize:14,fontWeight:800,color:urgC(res.combined_urgency)}}>{urgL(res.combined_urgency)}</div>
              </div>
              <div className="severity-badge" style={{background:"rgba(255,255,255,0.70)",fontSize:9,padding:"4px 8px"}}>
                <span className="dot" style={{background:urgC(res.combined_urgency),boxShadow:"0 0 0 4px "+urgBorder(res.combined_urgency),width:6,height:6}}/>
                {primary?.type==="ocular"?"OCULAR":"SIST√äMICO"}
              </div>
            </div>
          </div>
        )}

        {/* ‚ïê‚ïê‚ïê PRIMARY DIAGNOSIS ‚ïê‚ïê‚ïê */}
        {res&&primary&&!bothNormal&&(
          <div className="card detect-item" style={{
            padding:0,marginBottom:10,animation:"slideUp .7s ease",
            flexDirection:"column",gap:0,borderColor:urgBorder(primary.urgency),
            borderLeftWidth:3,borderLeftColor:urgC(primary.urgency)
          }}>
            <div style={{
              padding:"10px 12px 8px",
              background:primary.type==="systemic"?"linear-gradient(135deg,rgba(16,185,129,0.05),rgba(16,185,129,0.01))":"linear-gradient(135deg,rgba(37,99,235,0.05),rgba(37,99,235,0.01))",
              borderBottom:"1px solid var(--border)"
            }}>
              <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8}}>
                <div style={{fontSize:9,fontFamily:"var(--fm)",color:"var(--dim)",letterSpacing:".10em",fontWeight:700}}>‚óè DIAGN√ìSTICO PRINCIPAL</div>
                <div className={"severity-badge "+sevClass(primary.severity_level)} style={{fontSize:9,padding:"3px 7px"}}>
                  <span className="dot" style={{width:6,height:6}}/>
                  {primary.severity_level==="high"?"ALTA":primary.severity_level==="moderate"?"M√âDIA":"BAIXA"}
                </div>
              </div>
              <div style={{display:"flex",alignItems:"center",gap:10}}>
                <div style={{
                  width:38,height:38,borderRadius:12,
                  background:primary.type==="systemic"?"rgba(16,185,129,0.08)":"rgba(37,99,235,0.08)",
                  border:"1px solid "+(primary.type==="systemic"?"rgba(16,185,129,0.14)":"rgba(37,99,235,0.14)"),
                  display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,flexShrink:0
                }}>{primary.type==="systemic"?"ü´Ä":"üîç"}</div>
                <div style={{flex:1,minWidth:0}}>
                  <div style={{fontFamily:"var(--fd)",fontSize:17,color:"var(--ink)"}}>{primary.top_prediction_pt}</div>
                  <div style={{fontSize:10,color:"var(--muted)",fontWeight:500}}>{primary.type==="systemic"?"An√°lise Sist√™mica":"An√°lise Ocular"}</div>
                </div>
                <RingGauge pct={Math.round((primary.confidence||0)*100)} size={52} strokeWidth={5}
                  color={urgC(primary.urgency)}/>
              </div>
            </div>

            <div style={{padding:"10px 12px"}}>
              {/* Explanation */}
              {primary.explanation&&(
                <div style={{
                  background:"var(--bg2)",borderRadius:10,padding:10,marginBottom:10,
                  border:"1px solid rgba(17,24,39,0.05)"
                }}>
                  <div style={{fontSize:9,fontFamily:"var(--fm)",color:"var(--dim)",letterSpacing:".08em",marginBottom:4,fontWeight:700}}>O QUE √â ISSO?</div>
                  <div style={{fontSize:11,color:"var(--text)",lineHeight:1.55,fontWeight:400}}>{primary.explanation}</div>
                  {primary.severity&&(
                    <div style={{marginTop:6,display:"flex",alignItems:"center",gap:5}}>
                      <span style={{fontSize:11}}>{primary.severity_level==="none"?"‚úÖ":primary.severity_level==="low"?"üíö":primary.severity_level==="moderate"?"üü°":"üü†"}</span>
                      <span style={{fontSize:11,fontWeight:600,color:urgC(primary.severity_level==="high"?"high":primary.severity_level==="moderate"?"moderate":"low")}}>{primary.severity}</span>
                    </div>
                  )}
                </div>
              )}

              {/* Systemic alert */}
              {primary.systemic_alert&&(
                <div style={{
                  background:"rgba(245,158,11,0.04)",borderRadius:10,padding:9,marginBottom:10,
                  border:"1px solid rgba(245,158,11,0.12)"
                }}>
                  <div style={{fontSize:9,fontFamily:"var(--fm)",color:"var(--amber)",letterSpacing:".08em",fontWeight:700,marginBottom:3}}>‚ö† SINAL SIST√äMICO</div>
                  <div style={{fontSize:11,color:"var(--text)",lineHeight:1.5}}>
                    <strong>Doen√ßa:</strong> {primary.systemic_alert.disease}<br/>
                    <strong>Sinal:</strong> {primary.systemic_alert.sign}
                  </div>
                </div>
              )}

              {/* Findings */}
              {primary.findings&&(
                <div style={{marginBottom:10}}>
                  <div style={{fontSize:9,fontFamily:"var(--fm)",color:"var(--dim)",letterSpacing:".08em",marginBottom:5,fontWeight:700}}>ACHADOS</div>
                  {primary.findings.map((f,i)=>(
                    <div key={i} style={{
                      display:"flex",gap:6,marginBottom:3,fontSize:11,color:"var(--text)",
                      animation:`stagger ${.3+i*.08}s ease both`
                    }}>
                      <span style={{
                        width:15,height:15,borderRadius:999,flexShrink:0,
                        background:"rgba(16,185,129,0.08)",border:"1px solid rgba(16,185,129,0.12)",
                        display:"flex",alignItems:"center",justifyContent:"center",
                        fontSize:7,color:"var(--secondary2)",fontWeight:900,marginTop:1
                      }}>‚úì</span>
                      <span style={{lineHeight:1.45}}>{f}</span>
                    </div>
                  ))}
                </div>
              )}

              {/* Recommendation */}
              {primary.recommendation&&(
                <div style={{
                  background:"linear-gradient(135deg,rgba(37,99,235,0.04),rgba(16,185,129,0.03))",
                  borderRadius:10,padding:9,
                  border:"1px solid rgba(37,99,235,0.08)"
                }}>
                  <div style={{fontSize:11,color:"var(--primary2)",lineHeight:1.5,fontWeight:500}}>üíä {primary.recommendation}</div>
                </div>
              )}
            </div>
          </div>
        )}

        {/* ‚ïê‚ïê‚ïê SECONDARY ‚ïê‚ïê‚ïê */}
        {secondary&&(
          <div className="card" style={{
            padding:0,marginBottom:10,animation:"slideUp .8s ease",
            position:"relative",overflow:"hidden",
            borderLeftWidth:3,borderLeftStyle:"solid",
            borderLeftColor:secondary.type==="systemic"?"var(--secondary)":"var(--primary)"
          }}>
            <div style={{padding:"10px 12px"}}>
              <div style={{fontSize:9,fontFamily:"var(--fm)",color:"var(--dim)",letterSpacing:".10em",marginBottom:6,fontWeight:700}}>‚óè ACHADO SECUND√ÅRIO</div>
              <div style={{display:"flex",alignItems:"center",gap:8}}>
                <div style={{
                  width:34,height:34,borderRadius:10,
                  background:secondary.type==="systemic"?"rgba(16,185,129,0.08)":"rgba(37,99,235,0.08)",
                  border:"1px solid "+(secondary.type==="systemic"?"rgba(16,185,129,0.14)":"rgba(37,99,235,0.14)"),
                  display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,flexShrink:0
                }}>{secondary.type==="systemic"?"ü´Ä":"üîç"}</div>
                <div style={{flex:1,minWidth:0}}>
                  <div style={{fontSize:14,fontWeight:800,color:"var(--ink)"}}>{secondary.top_prediction_pt}</div>
                  <div style={{fontSize:10,color:"var(--muted)",fontWeight:400}}>{secondary.type==="systemic"?"Sist√™mico":"Ocular"} ¬∑ {secondary.explanation?.split(".")[0]}.</div>
                </div>
                <RingGauge pct={Math.round((secondary.confidence||0)*100)} size={44} strokeWidth={4}
                  color={urgC(secondary.urgency)}/>
              </div>
              {secondary.recommendation&&(
                <div style={{marginTop:8,fontSize:11,color:"var(--primary2)",paddingLeft:42,fontWeight:500}}>üíä {secondary.recommendation}</div>
              )}
            </div>
          </div>
        )}

        <EKGDivider/>

        {/* All scores (expandable) */}
        {res&&!bothNormal&&(
          <details className="card" style={{padding:10,marginBottom:10,marginTop:6}}>
            <summary style={{fontSize:9,fontFamily:"var(--fm)",color:"var(--dim)",letterSpacing:".08em",cursor:"pointer",outline:"none",fontWeight:700}}>TODAS AS PROBABILIDADES</summary>
            <div style={{marginTop:8,display:"flex",gap:8}} className="dual">
              <div style={{flex:1}}>
                <div style={{fontSize:8,fontFamily:"var(--fm)",color:"var(--primary)",marginBottom:5,fontWeight:700,letterSpacing:".08em"}}>OCULAR</div>
                {res.ocular_analysis?.all_scores&&Object.entries(res.ocular_analysis.all_scores).sort((a,b)=>b[1]-a[1]).map(([k,v])=>(
                  <div key={k} style={{marginBottom:3}}>
                    <div style={{display:"flex",justifyContent:"space-between",fontSize:9}}>
                      <span style={{color:"var(--text)",fontWeight:500}}>{k}</span>
                      <span style={{fontFamily:"var(--fm)",color:"var(--dim)"}}>{Math.round(v*100)}%</span>
                    </div>
                    <div style={{height:3,borderRadius:2,background:"rgba(37,99,235,0.08)"}}>
                      <div className="bf" style={{height:"100%",borderRadius:2,background:"var(--primary)",width:(v*100)+"%",opacity:v>.03?1:.15}}/>
                    </div>
                  </div>
                ))}
              </div>
              <div style={{flex:1}}>
                <div style={{fontSize:8,fontFamily:"var(--fm)",color:"var(--secondary2)",marginBottom:5,fontWeight:700,letterSpacing:".08em"}}>SIST√äMICO</div>
                {res.systemic_analysis?.all_scores&&Object.entries(res.systemic_analysis.all_scores).sort((a,b)=>b[1]-a[1]).map(([k,v])=>(
                  <div key={k} style={{marginBottom:3}}>
                    <div style={{display:"flex",justifyContent:"space-between",fontSize:9}}>
                      <span style={{color:"var(--text)",fontWeight:500}}>{k}</span>
                      <span style={{fontFamily:"var(--fm)",color:"var(--dim)"}}>{Math.round(v*100)}%</span>
                    </div>
                    <div style={{height:3,borderRadius:2,background:"rgba(16,185,129,0.08)"}}>
                      <div className="bf" style={{height:"100%",borderRadius:2,background:"var(--secondary)",width:(v*100)+"%",opacity:v>.03?1:.15}}/>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </details>
        )}

        {err&&<div className="card" style={{padding:10,marginBottom:10,borderColor:"rgba(239,68,68,0.18)",textAlign:"center",fontSize:11,color:"#ef4444",background:"rgba(239,68,68,0.04)"}}>{err}</div>}
      </div>
    )}

    {/* ‚ïê‚ïê‚ïê FOOTER (only shown in analysis view) ‚ïê‚ïê‚ïê */}
    {img&&(
      <div style={{marginTop:14,textAlign:"center",paddingBottom:8}}>
        <div style={{fontSize:11,color:"var(--dim)",lineHeight:1.4}}>
          ‚ö†Ô∏è Triagem de bem-estar ‚Äî n√£o √© diagn√≥stico m√©dico
          <span style={{display:"block",fontSize:9,fontFamily:"var(--fm)",letterSpacing:".04em",marginTop:2}}>EYECHECK V4.0 ¬∑ MobileNetV2 ¬∑ 18 condi√ß√µes ¬∑ BBG ¬© 2026</span>
        </div>
      </div>
    )}

    </main>
  </div>);
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>
