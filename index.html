<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>EYECHECK ‚Äî Seu olho conta a sa√∫de do seu corpo</title>
  <meta property="og:title" content="EYECHECK ‚Äî Screening Ocular + Sist√™mico por IA"/>
  <meta property="og:description" content="Detecta doen√ßas oculares e sinais de doen√ßas sist√™micas (diabetes, anemia, tireoide, colesterol) s√≥ com uma foto do olho. 2 modelos de IA, 18 condi√ß√µes."/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="https://em-content.zobj.net/source/apple/391/eyes_1f440.png"/>
  <meta name="description" content="EYECHECK ‚Äî IA que analisa seus olhos e detecta sinais de doen√ßas. 2 modelos, 18 condi√ß√µes, MobileNetV2."/>
  <meta name="theme-color" content="#0a0e1a"/>
  <meta name="mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üëÅÔ∏è</text></svg>"/>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;500;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{background:#051520;background-image:url('/static/bg.jpg');background-size:cover;background-position:center;background-attachment:fixed;overflow-x:hidden}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
    @keyframes scan{0%{top:0}100%{top:100%}}
    @keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    @keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}
    @keyframes slideInR{from{opacity:0;transform:translateX(20px)}to{opacity:1;transform:translateX(0)}}
    @keyframes glow{0%,100%{box-shadow:0 0 20px rgba(34,197,94,.2)}50%{box-shadow:0 0 40px rgba(34,197,94,.4)}}
    @keyframes pop{0%{transform:scale(0)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
    .bf{transition:width 1.2s cubic-bezier(.22,1,.36,1)}
    .btn{transition:all .2s;cursor:pointer}.btn:hover{transform:scale(1.03)}
    .hero-img{border-radius:50%;width:140px;height:140px;object-fit:cover;border:3px solid rgba(34,197,94,.4);box-shadow:0 0 40px rgba(34,197,94,.3),0 0 80px rgba(6,182,212,.15);animation:float 4s ease-in-out infinite}
    @media(max-width:700px){.dual{flex-direction:column !important}.hero-img{width:110px;height:110px}}
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
const { useState, useRef, useCallback } = React;

// V2 Ocular class metadata
const V2 = [
  { k:"normal",         c:"#22c55e", i:"‚úÖ", d:"Olho saud√°vel" },
  { k:"cataract",       c:"#a78bfa", i:"‚ö™", d:"Opacidade do cristalino" },
  { k:"conjunctivitis", c:"#ef4444", i:"üî¥", d:"Olho vermelho, inflama√ß√£o" },
  { k:"hemorrhage",     c:"#dc2626", i:"ü©∏", d:"Vaso rompido na esclera" },
  { k:"jaundice",       c:"#eab308", i:"üü°", d:"Esclera amarelada (f√≠gado)" },
  { k:"pterygium",      c:"#f97316", i:"üî∫", d:"Crescimento na conjuntiva" },
  { k:"ptosis",         c:"#3b82f6", i:"üëÅÔ∏è", d:"P√°lpebra ca√≠da" },
  { k:"stye_chalazion", c:"#ec4899", i:"ü´ß", d:"Ter√ßol/cal√°zio" },
  { k:"uveitis",        c:"#f59e0b", i:"üü†", d:"Inflama√ß√£o intraocular" },
];

// V3 Systemic class metadata
const V3 = [
  { k:"normal",            c:"#22c55e", i:"‚úÖ", d:"Sem sinais sist√™micos" },
  { k:"anemia",            c:"#f87171", i:"ü©∏", d:"Anemia ‚Äî conjuntiva p√°lida" },
  { k:"arcus_senilis",     c:"#94a3b8", i:"‚≠ï", d:"Arco senil ‚Äî colesterol" },
  { k:"blue_sclera",       c:"#60a5fa", i:"üîµ", d:"Esclera azulada" },
  { k:"diabetic_eye",      c:"#a78bfa", i:"üíú", d:"Sinais de diabetes" },
  { k:"exophthalmos",      c:"#fb923c", i:"üëÄ", d:"Olhos saltados ‚Äî tireoide" },
  { k:"kayser_fleischer",  c:"#d97706", i:"üü§", d:"Anel de cobre ‚Äî Wilson" },
  { k:"periorbital_edema", c:"#2dd4bf", i:"üíß", d:"Incha√ßo periorbital ‚Äî renal" },
  { k:"xanthelasma",       c:"#fbbf24", i:"üü°", d:"Placas na p√°lpebra ‚Äî colesterol" },
];

const gv2 = (k) => V2.find(c => c.k === k) || V2[0];
const gv3 = (k) => V3.find(c => c.k === k) || V3[0];
const mono = "'Space Mono', monospace";
const cardBg = "rgba(255,255,255,0.03)";
const cardBd = "1px solid rgba(255,255,255,0.06)";

const urgColor = (u) => u === "high" ? "#ef4444" : u === "moderate" ? "#eab308" : u === "low" ? "#a3e635" : "#22c55e";
const urgLabel = (u) => u === "high" ? "ALTA" : u === "moderate" ? "MODERADA" : u === "low" ? "BAIXA" : "NENHUMA";
const urgIcon  = (u) => u === "high" ? "üî¥" : u === "moderate" ? "üü°" : u === "low" ? "üü¢" : "‚úÖ";
const sevIcon  = (l) => l === "none" ? "‚úÖ" : l === "low" ? "üíö" : l === "moderate" ? "üü°" : "üü†";
const sevColor = (l) => l === "none" || l === "low" ? "#22c55e" : l === "moderate" ? "#eab308" : "#f97316";

const WA = (s) => <svg width={s} height={s} viewBox="0 0 24 24" fill="#fff"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>;

function App() {
  const [img, setImg] = useState(null);
  const [b64, setB64] = useState(null);
  const [res, setRes] = useState(null);
  const [busy, setBusy] = useState(false);
  const [err, setErr] = useState(null);
  const [drag, setDrag] = useState(false);
  const [apiReady, setApiReady] = useState(false);
  const fRef = useRef(null);
  const appUrl = typeof window !== "undefined" ? window.location.href : "";

  // Auto-wake server on page load (free tier cold start)
  React.useEffect(() => {
    const wake = () => fetch("/health").then(r => { if (r.ok) setApiReady(true); }).catch(() => {
      setTimeout(wake, 3000);
    });
    wake();
  }, []);

  const load = useCallback((file) => {
    if (!file?.type.startsWith("image/")) return;
    setRes(null); setErr(null);
    const reader = new FileReader();
    reader.onload = () => setB64(reader.result.split(",")[1]);
    reader.readAsDataURL(file);
    createImageBitmap(file).then(bmp => {
      const s = Math.min(1, 600 / Math.max(bmp.width, bmp.height));
      const w = Math.round(bmp.width * s), h = Math.round(bmp.height * s);
      const cv = document.createElement("canvas");
      cv.width = w; cv.height = h;
      cv.getContext("2d").drawImage(bmp, 0, 0, w, h);
      bmp.close();
      setImg(cv.toDataURL("image/jpeg", 0.75));
    }).catch(() => setImg("ok"));
  }, []);

  const analyze = async () => {
    if (!b64) return;
    setBusy(true); setErr(null); setRes(null);
    try {
      const r = await fetch("/predict/full", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ image: b64 })
      });
      const parsed = await r.json();
      if (parsed.error) throw new Error(parsed.error);
      setRes(parsed);
    } catch (e) { setErr("Erro: " + e.message); }
    finally { setBusy(false); }
  };

  const reset = () => { setImg(null); setB64(null); setRes(null); setErr(null); };

  const shareApp = () => {
    const msg = "üëÅÔ∏è EYECHECK ‚Äî IA que analisa seus olhos e detecta sinais de doen√ßas (diabetes, anemia, colesterol, tireoide) s√≥ com uma foto!\n\nüî¨ 2 modelos de IA, 18 condi√ß√µes detectadas\nüì± Funciona no celular, √© s√≥ tirar foto\n\nTesta a√≠: " + appUrl;
    window.open("https://api.whatsapp.com/send?text=" + encodeURIComponent(msg), "_blank");
  };

  const shareResult = () => {
    if (!res) return;
    const oc = res.ocular_analysis;
    const sy = res.systemic_analysis;
    const msg = "üëÅÔ∏è Fiz um screening com EYECHECK!\n\nüîç Olho: " + (oc?.top_prediction_pt || "?") + " (" + Math.round((oc?.confidence||0)*100) + "%)\nü´Ä Corpo: " + (sy?.top_prediction_pt || "?") + " (" + Math.round((sy?.confidence||0)*100) + "%)\n‚ö†Ô∏è Urg√™ncia: " + urgLabel(res.combined_urgency) + "\n\nüì± Fa√ßa o seu: " + appUrl;
    window.open("https://api.whatsapp.com/send?text=" + encodeURIComponent(msg), "_blank");
  };

  const bothNormal = res && res.ocular_analysis?.top_prediction === "normal" && res.systemic_analysis?.top_prediction === "normal";

  // ‚îÄ‚îÄ‚îÄ Reusable result card ‚îÄ‚îÄ‚îÄ
  const ResultCard = ({ analysis, title, icon, classList, getClass, animClass }) => {
    if (!analysis) return null;
    const cls = getClass(analysis.top_prediction);
    const conf = Math.round((analysis.confidence || 0) * 100);
    return (
      <div style={{ flex: 1, animation: animClass + " .6s ease" }}>
        {/* Card header */}
        <div style={{ display: "flex", alignItems: "center", gap: 7, marginBottom: 10 }}>
          <span style={{ fontSize: 18 }}>{icon}</span>
          <span style={{ fontSize: 11, fontFamily: mono, color: "#94a3b8", fontWeight: 700, letterSpacing: 1 }}>{title}</span>
          <span style={{ marginLeft: "auto", background: "rgba(255,255,255,.05)", border: "1px solid rgba(255,255,255,.08)", borderRadius: 6, padding: "2px 8px", fontSize: 8, fontFamily: mono, color: "#64748b" }}>{analysis.model?.split("‚Äî")[0]?.trim()}</span>
        </div>

        {/* Classification */}
        <div style={{ background: "linear-gradient(135deg," + cls.c + "15," + cls.c + "05)", border: "1px solid " + cls.c + "30", borderRadius: 14, padding: 14, marginBottom: 10 }}>
          <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
            <span style={{ fontSize: 28 }}>{cls.i}</span>
            <div style={{ flex: 1 }}>
              <div style={{ fontSize: 17, fontWeight: 700, color: cls.c }}>{analysis.top_prediction_pt}</div>
              <div style={{ fontSize: 10, color: "#94a3b8", marginTop: 1 }}>{cls.d}</div>
            </div>
            <div style={{ textAlign: "right" }}>
              <div style={{ fontFamily: mono, fontSize: 20, fontWeight: 700, color: cls.c }}>{conf}%</div>
              <div style={{ fontSize: 8, fontFamily: mono, color: urgColor(analysis.urgency) }}>
                {urgIcon(analysis.urgency)} {urgLabel(analysis.urgency)}
              </div>
            </div>
          </div>
          <div style={{ marginTop: 8, height: 4, borderRadius: 2, background: "rgba(255,255,255,.1)" }}>
            <div className="bf" style={{ height: "100%", borderRadius: 2, background: cls.c, width: conf + "%" }} />
          </div>
        </div>

        {/* Explanation + Severity */}
        {analysis.explanation && (
          <div style={{ background: cardBg, border: cardBd, borderRadius: 10, padding: 11, marginBottom: 10 }}>
            <div style={{ fontSize: 9, fontFamily: mono, color: "#64748b", marginBottom: 4, letterSpacing: 1 }}>O QUE √â ISSO?</div>
            <div style={{ fontSize: 11, color: "#e2e8f0", lineHeight: 1.5 }}>{analysis.explanation}</div>
            {analysis.severity && (
              <div style={{ marginTop: 6, display: "flex", alignItems: "center", gap: 6 }}>
                <span style={{ fontSize: 13 }}>{sevIcon(analysis.severity_level)}</span>
                <span style={{ fontSize: 10, fontWeight: 600, color: sevColor(analysis.severity_level) }}>{analysis.severity}</span>
              </div>
            )}
          </div>
        )}

        {/* Systemic alert (V3 only) */}
        {analysis.systemic_alert && (
          <div style={{ background: "rgba(249,115,22,.08)", border: "1px solid rgba(249,115,22,.2)", borderRadius: 10, padding: 10, marginBottom: 10 }}>
            <div style={{ fontSize: 9, fontFamily: mono, color: "#f97316", marginBottom: 3, letterSpacing: 1, fontWeight: 700 }}>‚ö† POSS√çVEL DOEN√áA SIST√äMICA</div>
            <div style={{ fontSize: 11, color: "#fdba74", lineHeight: 1.5 }}>
              <strong>Doen√ßa:</strong> {analysis.systemic_alert.disease}<br/>
              <strong>Sinal:</strong> {analysis.systemic_alert.sign}
            </div>
          </div>
        )}

        {/* Findings */}
        {analysis.findings && (
          <div style={{ background: cardBg, border: cardBd, borderRadius: 10, padding: 10, marginBottom: 10 }}>
            <div style={{ fontSize: 9, fontFamily: mono, color: "#64748b", marginBottom: 5, letterSpacing: 1 }}>ACHADOS</div>
            {analysis.findings.map((f, i) => (
              <div key={i} style={{ display: "flex", gap: 5, marginBottom: 2, fontSize: 10, color: "#cbd5e1" }}>
                <span style={{ color: cls.c }}>‚Üí</span><span>{f}</span>
              </div>
            ))}
          </div>
        )}

        {/* Scores */}
        {analysis.all_scores && (
          <details style={{ background: cardBg, border: cardBd, borderRadius: 10, padding: 10, marginBottom: 10 }}>
            <summary style={{ fontSize: 9, fontFamily: mono, color: "#64748b", letterSpacing: 1, cursor: "pointer" }}>TODAS AS PROBABILIDADES</summary>
            <div style={{ marginTop: 6 }}>
              {Object.entries(analysis.all_scores).sort((a,b) => b[1]-a[1]).map(([name, score]) => {
                const info = getClass(name);
                return (
                  <div key={name} style={{ marginBottom: 4 }}>
                    <div style={{ display: "flex", justifyContent: "space-between", fontSize: 9 }}>
                      <span style={{ color: info.c }}>{info.i} {name}</span>
                      <span style={{ fontFamily: mono, color: "#94a3b8" }}>{Math.round(score*100)}%</span>
                    </div>
                    <div style={{ height: 2, borderRadius: 1, background: "rgba(255,255,255,.06)" }}>
                      <div className="bf" style={{ height: "100%", borderRadius: 1, background: info.c, width: (score*100)+"%", opacity: score>.05?1:.3 }} />
                    </div>
                  </div>
                );
              })}
            </div>
          </details>
        )}

        {/* Recommendation */}
        {analysis.recommendation && (
          <div style={{ background: "rgba(245,158,11,.06)", border: "1px solid rgba(245,158,11,.12)", borderRadius: 10, padding: 10, fontSize: 11, color: "#fbbf24" }}>
            üí° {analysis.recommendation}
          </div>
        )}
      </div>
    );
  };

  return (
    <div style={{ minHeight: "100vh", background: "rgba(5,21,32,0.85)", fontFamily: "'DM Sans', system-ui, sans-serif", color: "#e2e8f0" }}>
      <input ref={fRef} type="file" accept="image/*" capture="environment" style={{ display: "none" }} onChange={e => load(e.target.files?.[0])} />

      {/* Header */}
      <div style={{ padding: "14px 20px", display: "flex", alignItems: "center", justifyContent: "space-between", borderBottom: "1px solid rgba(255,255,255,0.08)", backdropFilter: "blur(10px)", background: "rgba(5,21,32,0.6)" }}>
        <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
          <div style={{ width: 36, height: 36, borderRadius: 10, background: "linear-gradient(135deg,#06b6d4,#0891b2)", display: "flex", alignItems: "center", justifyContent: "center", fontSize: 17, fontWeight: 700, color: "#fff", boxShadow: "0 0 20px rgba(6,182,212,.3)" }}>E</div>
          <div>
            <div style={{ fontWeight: 700, fontSize: 16, color: "#f8fafc" }}>EYECHECK <span style={{ color: "#06b6d4", fontFamily: mono, fontSize: 11 }}>V3.0</span></div>
            <div style={{ fontSize: 8, color: "#64748b", fontFamily: mono, letterSpacing: .5 }}>DUAL MODEL ‚Ä¢ 18 CONDI√á√ïES ‚Ä¢ ML</div>
          </div>
        </div>
        <div style={{ background: apiReady ? "rgba(6,182,212,.15)" : "rgba(234,179,8,.1)", border: "1px solid " + (apiReady ? "rgba(6,182,212,.3)" : "rgba(234,179,8,.3)"), borderRadius: 8, padding: "4px 10px", fontSize: 9, fontFamily: mono, color: apiReady ? "#06b6d4" : "#eab308" }}>{apiReady ? "‚óè ONLINE" : "‚óå CONECTANDO..."}</div>
      </div>

      <div style={{ maxWidth: 960, margin: "0 auto", padding: "20px 16px" }}>

        {/* ‚ïê‚ïê‚ïê HOME SCREEN ‚ïê‚ïê‚ïê */}
        {!img && (
          <div style={{ animation: "fadeUp .6s ease" }}>
            {/* Hero section with eye image */}
            <div style={{ textAlign: "center", marginBottom: 24 }}>
              <img src="/static/hero-eye.jpg" alt="EYECHECK AI Eye" className="hero-img" style={{ marginBottom: 16 }} />
              <h2 style={{ fontSize: 22, fontWeight: 700, color: "#f0fdfa", marginBottom: 6, textShadow: "0 0 30px rgba(6,182,212,.3)" }}>Seu olho conta a sa√∫de do seu corpo</h2>
              <p style={{ color: "#94a3b8", fontSize: 12 }}>2 modelos de IA analisam sua foto simultaneamente</p>
            </div>

            {/* Upload area */}
            <div onClick={() => fRef.current?.click()}
              onDragOver={e => { e.preventDefault(); setDrag(true); }} onDragLeave={() => setDrag(false)}
              onDrop={e => { e.preventDefault(); setDrag(false); load(e.dataTransfer.files[0]); }}
              className="btn"
              style={{ border: "2px dashed " + (drag ? "#06b6d4" : "rgba(6,182,212,.2)"), borderRadius: 20, padding: "30px 24px", textAlign: "center", marginBottom: 16, background: drag ? "rgba(6,182,212,.05)" : "rgba(6,182,212,.03)", cursor: "pointer", backdropFilter: "blur(8px)" }}>
              <div style={{ fontSize: 28, marginBottom: 8 }}>üì∏</div>
              <div style={{ fontSize: 15, fontWeight: 600, color: "#e2e8f0", marginBottom: 4 }}>Tire uma foto do olho</div>
              <div style={{ fontSize: 11, color: "#64748b" }}>üì± C√¢mera no celular ‚Ä¢ üíª Upload no PC</div>
            </div>

            {/* Two model cards */}
            <div style={{ display: "flex", gap: 10, marginBottom: 14 }} className="dual">
              <div style={{ flex: 1, background: "rgba(6,182,212,.04)", border: "1px solid rgba(6,182,212,.12)", borderRadius: 14, padding: 14, backdropFilter: "blur(8px)" }}>
                <div style={{ fontSize: 10, fontFamily: mono, color: "#06b6d4", marginBottom: 8, fontWeight: 700 }}>üîç AN√ÅLISE OCULAR</div>
                <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 5 }}>
                  {V2.filter(c=>c.k!=="normal").map(c => (
                    <div key={c.k} style={{ display: "flex", alignItems: "center", gap: 5, fontSize: 9, color: "#94a3b8" }}>
                      <span>{c.i}</span><span style={{ color: c.c }}>{c.d.split("‚Äî")[0]}</span>
                    </div>
                  ))}
                </div>
              </div>
              <div style={{ flex: 1, background: "rgba(6,182,212,.04)", border: "1px solid rgba(6,182,212,.12)", borderRadius: 14, padding: 14, backdropFilter: "blur(8px)" }}>
                <div style={{ fontSize: 10, fontFamily: mono, color: "#f97316", marginBottom: 8, fontWeight: 700 }}>ü´Ä AN√ÅLISE SIST√äMICA</div>
                <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 5 }}>
                  {V3.filter(c=>c.k!=="normal").map(c => (
                    <div key={c.k} style={{ display: "flex", alignItems: "center", gap: 5, fontSize: 9, color: "#94a3b8" }}>
                      <span>{c.i}</span><span style={{ color: c.c }}>{c.d.split("‚Äî")[0]}</span>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* WhatsApp share */}
            <button onClick={shareApp} className="btn"
              style={{ width: "100%", padding: "13px 20px", borderRadius: 12, border: "none",
                background: "linear-gradient(135deg, #25D366, #128C7E)", color: "#fff", fontSize: 13, fontWeight: 700,
                display: "flex", alignItems: "center", justifyContent: "center", gap: 10,
                boxShadow: "0 4px 20px rgba(37,211,102,.3)" }}>
              {WA(18)} Enviar pra um amigo
            </button>
          </div>
        )}

        {/* ‚ïê‚ïê‚ïê IMAGE + RESULTS ‚ïê‚ïê‚ïê */}
        {img && (
          <div style={{ animation: "fadeUp .5s ease" }}>
            {/* Image preview */}
            <div style={{ position: "relative", borderRadius: 14, overflow: "hidden", border: "1px solid rgba(255,255,255,.1)", background: "#000", marginBottom: 12, maxHeight: 300 }}>
              {img && img !== "ok" ? (
                <img src={img} alt="Eye" style={{ width: "100%", display: "block", maxHeight: 300, objectFit: "contain" }} />
              ) : (
                <div style={{ width: "100%", height: 140, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", gap: 6 }}>
                  <span style={{ fontSize: 32 }}>üì∏</span>
                  <span style={{ fontSize: 11, color: "#22c55e", fontWeight: 600 }}>Foto carregada</span>
                </div>
              )}
              {busy && (
                <div style={{ position: "absolute", inset: 0, background: "rgba(0,0,0,.4)", display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", gap: 10 }}>
                  <div style={{ position: "absolute", left: 0, right: 0, height: 2, background: "linear-gradient(90deg,transparent,#22c55e,transparent)", animation: "scan 1.5s linear infinite" }} />
                  <div style={{ background: "rgba(0,0,0,.7)", borderRadius: 10, padding: "10px 20px", fontSize: 11, fontWeight: 600, fontFamily: mono, color: "#22c55e", animation: "pulse 1.5s infinite" }}>
                    ANALISANDO COM 2 MODELOS...
                  </div>
                </div>
              )}
            </div>

            {/* Action buttons */}
            <div style={{ display: "flex", gap: 8, marginBottom: 16 }}>
              {!busy && !res && <button onClick={apiReady ? analyze : undefined} className="btn" style={{ flex: 1, padding: "12px", borderRadius: 10, border: "none", background: apiReady ? "linear-gradient(135deg,#06b6d4,#0891b2)" : "rgba(255,255,255,.1)", color: apiReady ? "#fff" : "#64748b", fontSize: 14, fontWeight: 700, boxShadow: apiReady ? "0 4px 20px rgba(6,182,212,.3)" : "none", opacity: apiReady ? 1 : 0.6 }}>{apiReady ? "üî¨ Analisar Olho" : "‚è≥ Servidor iniciando..."}</button>}
              <button onClick={reset} className="btn" style={{ flex: res ? 1 : 0, padding: "12px", borderRadius: 10, border: "1px solid rgba(255,255,255,.15)", background: "rgba(255,255,255,.05)", color: "#94a3b8", fontSize: 12, fontWeight: 600 }}>{res ? "üì∑ Nova Foto" : "‚úï"}</button>
              {res && <button onClick={shareResult} className="btn" style={{ flex: 1, padding: "12px", borderRadius: 10, border: "none", background: "linear-gradient(135deg, #25D366, #128C7E)", color: "#fff", fontSize: 12, fontWeight: 700, display: "flex", alignItems: "center", justifyContent: "center", gap: 6 }}>
                {WA(14)} Compartilhar
              </button>}
            </div>

            {/* Both Normal Celebration */}
            {bothNormal && (
              <div style={{ textAlign: "center", padding: "20px 16px", marginBottom: 16, background: "rgba(34,197,94,.08)", border: "1px solid rgba(34,197,94,.2)", borderRadius: 16, animation: "pop .5s ease" }}>
                <div style={{ fontSize: 48 }}>‚úÖ</div>
                <div style={{ fontSize: 20, fontWeight: 700, color: "#22c55e", marginTop: 6 }}>Olhos saud√°veis!</div>
                <div style={{ fontSize: 12, color: "#86efac", marginTop: 4 }}>Nenhum sinal de doen√ßa ocular ou sist√™mica detectado</div>
              </div>
            )}

            {/* Combined urgency banner */}
            {res && !bothNormal && (
              <div style={{ background: urgColor(res.combined_urgency) + "12", border: "1px solid " + urgColor(res.combined_urgency) + "30", borderRadius: 12, padding: "10px 14px", marginBottom: 16, display: "flex", alignItems: "center", gap: 10 }}>
                <span style={{ fontSize: 20 }}>{urgIcon(res.combined_urgency)}</span>
                <div>
                  <div style={{ fontSize: 9, fontFamily: mono, color: urgColor(res.combined_urgency), letterSpacing: 1, fontWeight: 700 }}>URG√äNCIA COMBINADA</div>
                  <div style={{ fontSize: 12, color: urgColor(res.combined_urgency), fontWeight: 600 }}>{urgLabel(res.combined_urgency)}</div>
                </div>
              </div>
            )}

            {/* ‚ïê‚ïê‚ïê DUAL RESULT CARDS ‚ïê‚ïê‚ïê */}
            {res && (
              <div style={{ display: "flex", gap: 14 }} className="dual">
                <ResultCard
                  analysis={res.ocular_analysis}
                  title="AN√ÅLISE OCULAR"
                  icon="üîç"
                  classList={V2}
                  getClass={gv2}
                  animClass="slideIn"
                />
                <ResultCard
                  analysis={res.systemic_analysis}
                  title="AN√ÅLISE SIST√äMICA"
                  icon="ü´Ä"
                  classList={V3}
                  getClass={gv3}
                  animClass="slideInR"
                />
              </div>
            )}

            {err && <div style={{ marginTop: 12, background: "rgba(239,68,68,.1)", border: "1px solid rgba(239,68,68,.2)", borderRadius: 10, padding: 11, fontSize: 11, color: "#f87171", textAlign: "center" }}>{err}</div>}
          </div>
        )}

        {/* Disclaimer */}
        <div style={{ marginTop: 24, padding: 12, borderRadius: 10, background: "rgba(255,255,255,.02)", border: "1px solid rgba(255,255,255,.05)", textAlign: "center" }}>
          <div style={{ fontSize: 9, color: "#475569", fontFamily: mono, lineHeight: 1.6 }}>
            ‚ö†Ô∏è TRIAGEM DE BEM-ESTAR ‚Äî N√ÉO √â DIAGN√ìSTICO M√âDICO<br/>
            EYECHECK V3.0 ‚Äî Ferramenta educacional (MIT xPRO). Consulte um m√©dico para diagn√≥stico.
          </div>
          <div style={{ marginTop: 6, fontSize: 8, color: "#334155", fontFamily: mono }}>
            V2: MobileNetV2 TFLite (9 classes oculares) ‚Ä¢ V3: MobileNetV2 TFLite (9 classes sist√™micas) ‚Ä¢ BBG ¬© 2026
          </div>
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
